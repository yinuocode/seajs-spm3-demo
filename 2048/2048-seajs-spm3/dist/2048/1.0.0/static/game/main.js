!function(e){function t(r){if(o[r])return o[r].exports;var n=o[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){e.exports=o(2)},function(e,t){"use strict";var o={};o.documentWidth=window.screen.availWidth,o.gridContainerWidth=.92*o.documentWidth,o.cellSideLength=.18*o.documentWidth,o.cellSpace=.04*o.documentWidth,o.getPostTop=function(e,t){return o.cellSpace+e*(o.cellSpace+o.cellSideLength)},o.getPostLeft=function(e,t){return o.cellSpace+t*(o.cellSpace+o.cellSideLength)},o.getNumberBackgroundColor=function(e){switch(e){case 2:return"#eee4da";case 4:return"#ede0c8";case 8:return"#f2b179";case 16:return"#f59563";case 32:return"#f67c5f";case 64:return"#f65e3b";case 128:return"#edcf72";case 256:return"#edcc61";case 512:return"#9c0";case 1024:return"#33b5e5";case 2048:return"#09c";case 4096:return"#a6c";case 8192:return"#93c"}return"black"},o.getNumberColor=function(e){return 4>=e?"#776e65":"white"},o.nospace=function(e){for(var t=0;4>t;t++)for(var o=0;4>o;o++)if(0===e[t][o])return!1;return!0},o.canMoveLeft=function(e){for(var t=0;4>t;t++)for(var o=1;4>o;o++)if(0!==e[t][o]&&(0===e[t][o-1]||e[t][o-1]===e[t][o]))return!0;return!1},o.canMoveUp=function(e){for(var t=0;4>t;t++)for(var o=1;4>o;o++)if(0!==e[o][t]&&(0===e[o-1][t]||e[o-1][t]===e[o][t]))return!0;return!1},o.canMoveRight=function(e){for(var t=0;4>t;t++)for(var o=2;o>=0;o--)if(0!==e[t][o]&&(0===e[t][o+1]||e[t][o+1]===e[t][o]))return!0;return!1},o.canMoveDown=function(e){for(var t=0;4>t;t++)for(var o=2;o>=0;o--)if(0!==e[o][t]&&(0===e[o+1][t]||e[o+1][t]===e[o][t]))return!0},o.noBlockHorizontal=function(e,t,o,r){for(var n=t+1;o>n;n++)if(0!==r[e][n])return!1;return!0},o.noBlockVertical=function(e,t,o,r){for(var n=t+1;o>n;n++)if(0!==r[n][e])return!1;return!0},o.nomove=function(e){return o.canMoveUp(e)||o.canMoveRight(e)||o.canMoveDown(e)||o.canMoveLeft(e)?!1:!0},e.exports=o},function(e,t,o){"use strict";function r(){m.documentWidth>500&&(m.gridContainerWidth=500,m.cellSpace=20,m.cellSideLength=100),$("#grid-container").css({width:m.gridContainerWidth-2*m.cellSpace,height:m.gridContainerWidth-2*m.cellSpace,padding:m.cellSpace,"border-radius":.02*m.gridContainerWidth}),$(".grid-cell").css({width:m.cellSideLength,height:m.cellSideLength,border:.02*m.cellSideLength})}function n(){c(),a(),a()}function c(){for(var e=0;4>e;e++)for(var t=0;4>t;t++){var o=$("#grid-cell-"+e+"-"+t);o.css("top",m.getPostTop(e,t)),o.css("left",m.getPostLeft(e,t))}for(var e=0;4>e;e++){g[e]=new Array,M[e]=new Array;for(var t=0;4>t;t++)g[e][t]=0,M[e][t]=!1}i(),p=0,v.updateScore(p)}function i(){$(".number-cell").remove();for(var e=0;4>e;e++)for(var t=0;4>t;t++){$("#grid-container").append('<div class="number-cell" id="number-cell-'+e+"-"+t+'"></div>');var o=$("#number-cell-"+e+"-"+t);0===g[e][t]?o.css({width:"0px",height:"0px",top:m.getPostTop(e,t)+m.cellSideLength/2,left:m.getPostLeft(e,t)+m.cellSideLength/2}):(o.css({width:m.cellSideLength,height:m.cellSideLength,top:m.getPostTop(e,t),left:m.getPostLeft(e,t),"background-color":m.getNumberBackgroundColor(g[e][t]),color:m.getNumberColor(g[e][t])}).text(g[e][t]),512===g[e][t]&&o.css("font-size","40px"),g[e][t]>=1e3&&o.css("font-size","30px")),M[e][t]=!1}$(".number-cell").css("line-height",m.cellSideLength+"px"),$(".number-cell").css("font-size",.6*m.cellSideLength+"px")}function a(){if(m.nospace(g))return!1;for(var e=parseInt(Math.floor(4*Math.random())),t=parseInt(Math.floor(4*Math.random())),o=0;50>o&&0!==g[e][t];)e=parseInt(Math.floor(4*Math.random())),t=parseInt(Math.floor(4*Math.random())),o++;if(50===o)for(var r=0;4>r;r++)for(var n=0;4>n;n++)0===g[r][n]&&(e=r,t=n);var c=Math.random()<.5?2:4;return g[e][t]=c,v.showNumberWithAnimation(e,t,c),!0}function u(){if(!m.canMoveLeft(g))return!1;for(var e=0;4>e;e++)for(var t=1;4>t;t++)if(0!==g[e][t])for(var o=0;t>o;o++)0===g[e][o]&&m.noBlockHorizontal(e,o,t,g)?(v.showMoveAnimation(e,t,e,o),g[e][o]=g[e][t],g[e][t]=0):g[e][o]!==g[e][t]||!m.noBlockHorizontal(e,o,t,g)||M[e][o]||(v.showMoveAnimation(e,t,e,o),g[e][o]+=g[e][t],g[e][t]=0,p+=g[e][o],v.updateScore(p),M[e][o]=!0);return setTimeout(i,200),!0}function s(){if(!m.canMoveUp(g))return!1;for(var e=0;4>e;e++)for(var t=1;4>t;t++)if(0!==g[t][e])for(var o=0;t>o;o++)0===g[o][e]&&m.noBlockVertical(e,o,t,g)?(v.showMoveAnimation(t,e,o,e),g[o][e]=g[t][e],g[t][e]=0):g[o][e]!==g[t][e]||!m.noBlockVertical(e,o,t,g)||M[o][e]||(v.showMoveAnimation(t,e,o,e),g[o][e]+=g[t][e],g[t][e]=0,p+=g[o][e],M[o][e]=!0,v.updateScore(p));return setTimeout(i,200),!0}function l(){if(!m.canMoveRight(g))return!1;for(var e=0;4>e;e++)for(var t=2;t>=0;t--)if(0!==g[e][t])for(var o=3;o>t;o--)0===g[e][o]&&m.noBlockHorizontal(e,t,o,g)?(v.showMoveAnimation(e,t,e,o),g[e][o]=g[e][t],g[e][t]=0):g[e][o]!==g[e][t]||!m.noBlockHorizontal(e,t,o,g)||M[e][o]||(v.showMoveAnimation(e,t,e,o),g[e][o]+=g[e][t],g[e][t]=0,p+=g[e][o],v.updateScore(p),M[e][o]=!0);return setTimeout(i,200),!0}function f(){if(!m.canMoveDown(g))return!1;for(var e=0;4>e;e++)for(var t=2;t>=0;t--)if(0!==g[t][e])for(var o=3;o>t;o--)0===g[o][e]&&m.noBlockVertical(e,t,o,g)?(v.showMoveAnimation(t,e,o,e),g[o][e]=g[t][e],g[t][e]=0):g[o][e]!==g[t][e]||!m.noBlockVertical(e,t,o,g)||M[o][e]||(v.showMoveAnimation(t,e,o,e),g[o][e]+=g[t][e],g[t][e]=0,p+=g[o][e],M[o][e]=!0,v.updateScore(p));return setTimeout(i,200),!0}function d(){m.nospace(g)&&m.nomove(g)&&h()}function h(){alert("gameover")}var v=o(3),m=o(1),g=new Array,p=0,M=[],b=0,S=0,w=0,T=0;$(function(){r(),n()}),$("#newgamebutton").on("click",function(){n()}),$(document).keydown(function(e){switch(e.keyCode){case 37:e.preventDefault(),u()&&(setTimeout(a,210),setTimeout(d,300));break;case 38:e.preventDefault(),s()&&(setTimeout(a,210),setTimeout(d,300));break;case 39:e.preventDefault(),l()&&(setTimeout(a,210),setTimeout(d,300));break;case 40:e.preventDefault(),f()&&(setTimeout(a,210),setTimeout(d,300))}}),document.addEventListener("touchstart",function(e){b=e.touches[0].pageX,S=e.touches[0].pageY,console.log(S)}),document.addEventListener("touchmove",function(e){e.preventDefault()}),document.addEventListener("touchend",function(e){w=e.changedTouches[0].pageX,T=e.changedTouches[0].pageY;var t=w-b,o=T-S;Math.abs(t)<.3*m.documentWidth&&Math.abs(o)<.3*m.documentWidth||(Math.abs(t)>Math.abs(o)?t>0?l()&&(setTimeout(a,210),setTimeout(d,300)):u()&&(setTimeout(a,210),setTimeout(d,300)):o>0?f()&&(setTimeout(a,210),setTimeout(d,300)):s()&&(setTimeout(a,210),setTimeout(d,300)))})},function(e,t,o){"use strict";var r=o(1),n={};n.showNumberWithAnimation=function(e,t,o){var n=$("#number-cell-"+e+"-"+t);n.css({"background-color":r.getNumberBackgroundColor(o),color:r.getNumberColor(o)}).text(o),n.animate({width:r.cellSideLength,height:r.cellSideLength,top:r.getPostTop(e,t),left:r.getPostLeft(e,t)},100)},n.showMoveAnimation=function(e,t,o,n){var c=$("#number-cell-"+e+"-"+t);c.animate({top:r.getPostTop(o,n),left:r.getPostLeft(o,n)},200)},n.updateScore=function(e){$("#score").text(e)},e.exports=n}]);